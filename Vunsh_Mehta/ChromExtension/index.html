<!DOCTYPE html>
<html lang="en">
<!-- http://www.mc-computing.com/Languages/Javascript/Caret_Position.html -->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Test</title>
</head>

<body>

    <style>
        #wrapper {
            width: 100%;
        }

        #caret {
            position: absolute;
            left: 5px;
            transition: left 5s linear;
            height: 40px;
            width: 2px;
            background: #0a0a0a;
        }

        #caret.endOfLine {
            left: 95%;
        }
    </style>

    <div id='wrapper'>
        <button>Run/Reset!</button>
        <div id='caret'>
        </div>
    </div>

    <textarea name="" id="text" cols="80" rows="30"></textarea>

    <script>
        $('button').click(function () {
            $('#caret').toggleClass('endOfLine');
        })
    </script>


    <br><br><br><br><br>


    <script type = "text/javascript">
        window.addEventListener ("load", function () {
          var input = document.getElementsByTagName ("input");
          
          input[0].addEventListener ("keydown", function () {
            alert ("Caret position: " + this.selectionStart);
            
            // You can also set the caret: this.selectionStart = 2;
          });
        });
      </script>
      
      <title>Test</title>
    </head>
  
    <body>
      <input type = "text">
    </body>

    <script>
        function getCaretCharacterOffsetWithin(element) {
            var caretOffset = 0;
            var doc = element.ownerDocument || element.document;
            var win = doc.defaultView || doc.parentWindow;
            var sel;
            if (typeof win.getSelection != "undefined") {
                sel = win.getSelection();
                if (sel.rangeCount > 0) {
                    var range = win.getSelection().getRangeAt(0);
                    var preCaretRange = range.cloneRange();
                    preCaretRange.selectNodeContents(element);
                    preCaretRange.setEnd(range.endContainer, range.endOffset);
                    caretOffset = preCaretRange.toString().length;
                }
            } else if ((sel = doc.selection) && sel.type != "Control") {
                var textRange = sel.createRange();
                var preCaretTextRange = doc.body.createTextRange();
                preCaretTextRange.moveToElementText(element);
                preCaretTextRange.setEndPoint("EndToEnd", textRange);
                caretOffset = preCaretTextRange.text.length;
            }
            return caretOffset;
        }

        var update = function () {
            console.log(getCaretCharacterOffsetWithin(this));
        };
        $('#text').on("mousedown mouseup keydown keyup", update);
    </script>

</body>

</html>